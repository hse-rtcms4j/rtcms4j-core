openapi: 3.0.3
info:
  title: RTCMS4J Core-service API
  version: 1.0.0
servers:
  - url: /api/v1

paths:
  ########################
  # Managing namespaces: #
  ########################
  /namespace:
    get:
      tags:
        - Core
      summary: Get all namespaces
      operationId: findAllNamespaces
      parameters:
        - name: name
          description: Search by name param
          in: query
          required: false
          schema:
            type: string
        - name: pageable
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Pageable'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedModelNamespaceDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Core
      summary: Create new namespace
      operationId: createNamespace
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NamespaceCreateRequest'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NamespaceDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}:
    get:
      tags:
        - Core
      summary: Get namespace
      operationId: getNamespace
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NamespaceDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: NamespaceDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Core
      summary: Update namespace
      operationId: updateNamespace
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NamespaceUpdateRequest'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NamespaceDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: NamespaceDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Core
      summary: Delete namespace
      operationId: deleteNamespace
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: NamespaceDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/admin:
    get:
      tags:
        - Core
      summary: Get namespace admins
      operationId: getNamespaceAdmins
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserInfoDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/admin/{uid}:
    post:
      tags:
        - Core
      summary: Add namespace admin
      operationId: addNamespaceAdmin
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: uid
          description: User id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfoDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Core
      summary: Remove namespace admin
      operationId: removeNamespaceAdmin
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: uid
          description: User id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: UserInfo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  ##########################
  # Managing applications: #
  ##########################
  /namespace/{nid}/application:
    get:
      tags:
        - Core
      summary: Get all namespace applications
      operationId: findAllApplications
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: name
          description: Search by name param
          in: query
          required: false
          schema:
            type: string
        - name: pageable
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Pageable'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedModelApplicationDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Core
      summary: Create new namespace application
      operationId: createApplication
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationCreateRequest'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}:
    get:
      tags:
        - Core
      summary: Get namespace application
      operationId: getApplication
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ApplicationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Core
      summary: Update namespace application
      operationId: updateApplication
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationUpdateRequest'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ApplicationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Core
      summary: Delete namespace application
      operationId: deleteApplication
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ApplicationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/manager:
    get:
      tags:
        - Core
      summary: Get namespace application managers
      operationId: getApplicationManagers
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserInfoDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/manager/{uid}:
    post:
      tags:
        - Core
      summary: Add namespace application manager
      operationId: addApplicationManager
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: uid
          description: User id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfoDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Core
      summary: Remove namespace application manager
      operationId: removeApplicationManager
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: uid
          description: User id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: UserInfo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/access-token:
    get:
      tags:
        - Core
      summary: Get namespace application token
      operationId: getApplicationAccessToken
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccessTokenDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Core
      summary: Update namespace application token
      operationId: updateApplicationAccessToken
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessTokenDto'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccessTokenDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  ############################
  # Managing configurations: #
  ############################
  /namespace/{nid}/application/{aid}/configuration:
    get:
      tags:
        - Core
      summary: Get namespace application configurations
      operationId: findAllConfigurations
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: name
          description: Search by name param
          in: query
          required: false
          schema:
            type: string
        - name: pageable
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Pageable'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedModelConfigurationDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Core
      summary: Create new namespace application configuration
      operationId: createConfiguration
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigurationDtoCreateRequest'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationDetailedDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/configuration/{cid}:
    get:
      tags:
        - Core
      summary: Get namespace application configuration
      operationId: getConfiguration
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationDetailedDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Core
      summary: Update namespace application configuration
      operationId: updateConfiguration
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigurationDtoUpdateRequest'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationDetailedDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Core
      summary: Delete namespace application configuration
      operationId: deleteConfiguration
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/configuration/{cid}/values:
    get:
      tags:
        - Core
      summary: Get namespace application configuration values
      operationId: getConfigurationValues
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/octet-stream:
              schema:
                $ref: '#/components/schemas/ConfigurationValuesData'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Core
      summary: Update namespace application configuration values
      operationId: updateConfigurationValues
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/octet-stream:
            schema:
              $ref: '#/components/schemas/ConfigurationValuesData'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationCommitDetailedDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/configuration/{cid}/schema:
    get:
      tags:
        - Core
      summary: Get namespace application configuration schema
      operationId: getConfigurationSchema
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/octet-stream:
              schema:
                $ref: '#/components/schemas/ConfigurationSchemaData'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationDto not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Core
      summary: Update namespace application configuration schema
      operationId: updateConfigurationSchema
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/octet-stream:
            schema:
              $ref: '#/components/schemas/ConfigurationSchemaData'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationCommitDetailedDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/configuration/{cid}/version:
    get:
      tags:
        - Core
      summary: Get namespace application configuration versions
      operationId: getConfigurationVersions
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ConfigurationCommitDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /namespace/{nid}/application/{aid}/configuration/{cid}/version/{commitHash}:
    get:
      tags:
        - Core
      summary: Get namespace application configuration version
      operationId: getConfigurationVersion
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: commitHash
          description: Version commit hash
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigurationCommitDetailedDto'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationVersionWithState not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Core
      summary: Switch namespace application configuration to version
      operationId: switchConfigurationVersion
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: commitHash
          description: Version commit hash
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationVersionWithState not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Core
      summary: Delete namespace application configuration version
      operationId: deleteConfigurationVersion
      parameters:
        - name: nid
          description: Namespace id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: aid
          description: Application id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: cid
          description: Container id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: commitHash
          description: Version commit hash
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: ConfigurationVersionWithState not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '405':
          $ref: '#/components/responses/MethodNotAllowed'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  responses:
    BadRequest:
      description: Wrong or unexpected
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Unauthorized:
      description: Wrong token or authorization failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    MethodNotAllowed:
      description: Wrong method
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Forbidden:
      description: Not enough permissions to access
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    InternalServerError:
      description: Error on server side
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

  schemas:
    Pageable:
      description: minimal Pageable query parameters
      type: object
      properties:
        page:
          type: integer
          format: int64
        size:
          type: integer
          format: int64

    PageMetadata:
      type: object
      required:
        - size
        - number
        - totalElements
        - totalPages
      properties:
        size:
          type: integer
          format: int64
          description: The size of the page
        totalElements:
          type: integer
          format: int64
          description: The total number of elements
        totalPages:
          type: integer
          format: int64
          description: The total number of pages
        number:
          type: integer
          format: int64
          description: The current page number

    ErrorResponse:
      type: object
      required:
        - httpCode
        - httpStatus
      properties:
        httpCode:
          type: integer
          format: int32
        httpStatus:
          type: string
        detailCode:
          type: integer
          format: int32
        detailMessage:
          type: string

    PagedModelNamespaceDto:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/NamespaceDto'
        page:
          $ref: '#/components/schemas/PageMetadata'

    NamespaceDto:
      type: object
      required:
        - id
        - name
        - description
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
          minLength: 1
          maxLength: 64
        description:
          type: string
          minLength: 1
          maxLength: 512

    NamespaceCreateRequest:
      type: object
      required:
        - name
        - description
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 64
        description:
          type: string
          minLength: 1
          maxLength: 512

    NamespaceUpdateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 64
        description:
          type: string
          minLength: 1
          maxLength: 512

    UserInfoDto:
      type: object
      required:
        - sub
      properties:
        sub:
          type: string
          format: uuid

    PagedModelApplicationDto:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/ApplicationDto'
        page:
          $ref: '#/components/schemas/PageMetadata'

    ApplicationDto:
      type: object
      required:
        - id
        - namespaceId
        - name
        - description
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
          minLength: 1
          maxLength: 64
        description:
          type: string
          minLength: 1
          maxLength: 512

    ApplicationCreateRequest:
      type: object
      required:
        - name
        - description
      properties:
        namespaceId:
          type: integer
          format: int64
        name:
          type: string
          minLength: 1
          maxLength: 64
        description:
          type: string
          minLength: 1
          maxLength: 512

    ApplicationUpdateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 64
        description:
          type: string
          minLength: 1
          maxLength: 512

    AccessTokenDto:
      type: object
      required:
        - password
      properties:
        password:
          type: string
          minLength: 64
          maxLength: 64

    PagedModelConfigurationDto:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/ConfigurationDto'
        page:
          $ref: '#/components/schemas/PageMetadata'

    ConfigurationDto:
      type: object
      required:
        - id
        - namespaceId
        - applicationId
        - name
        - schemaSourceType
      properties:
        # not null
        id:
          type: integer
          format: int64
        namespaceId:
          type: integer
          format: int64
        applicationId:
          type: integer
          format: int64
        name:
          type: string
          minLength: 1
          maxLength: 64
        schemaSourceType:
          $ref: '#/components/schemas/SourceType'
        # nullable
        commitHash:
          type: string
        stream-key:
          type: string

    ConfigurationDetailedDto:
      allOf:
        - $ref: '#/components/schemas/ConfigurationDto'
        - type: object
          properties:
            valuesData:
              $ref: '#/components/schemas/ConfigurationValuesData'
            schemaData:
              $ref: '#/components/schemas/ConfigurationSchemaData'

    ConfigurationDtoCreateRequest:
      type: object
      required:
        - name
        - schemaSourceType
      properties:
        name:
          type: string
          minLength: 1
        schemaSourceType:
          $ref: '#/components/schemas/SourceType'

    ConfigurationDtoUpdateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        schemaSourceType:
          $ref: '#/components/schemas/SourceType'

    ConfigurationValuesData:
      description: Json
      type: string

    ConfigurationSchemaData:
      description: Json schema
      type: string

    ConfigurationCommitDto:
      type: object
      required:
        - commitHash
        - sourceType
        - sourceIdentity
      properties:
        # not null
        commitHash:
          type: string
        sourceType:
          $ref: '#/components/schemas/SourceType'
        sourceIdentity:
          type: string

    ConfigurationCommitDetailedDto:
      allOf:
        - $ref: '#/components/schemas/ConfigurationCommitDto'
        - type: object
          properties:
            valuesData:
              $ref: '#/components/schemas/ConfigurationValuesData'
            schemaData:
              $ref: '#/components/schemas/ConfigurationSchemaData'

    SourceType:
      type: string
      enum:
        - USER
        - SERVICE
